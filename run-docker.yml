name: $(BuildDefinitionName)-$(SourceBranchName)-$(date:yyyyMMdd)$(Rev:.r)

pr: none

trigger:
  batch: true
  branches:
    include:
    - main

pool: docker

steps:
- script: docker-compose -p "monitoring" build --build-arg PIHOLE_API_TOKEN=$(PIHOLE_API_TOKEN) --build-arg PIHOLE_HOSTNAME=$(PIHOLE_HOSTNAME) --build-arg RELAY_USERNAME=$(RELAY_USERNAME) --build-arg RELAY_PASSWORD=$(RELAY_PASSWORD)
  displayName: 'Docker Compose Down'
- script: docker-compose -p "monitoring" down
  displayName: 'Docker Compose Down'
- script: docker-compose -p "monitoring" up -d
  displayName: 'Docker Compose Up'
